function manageUserData(n){BootstrapDialog.show({cssClass:"login-dialog",title:Number(n)==0?"<b>ADD USER<\/b>":"<b>EDIT USER<\/b>",type:Number(n)==0?BootstrapDialog.TYPE_PRIMARY:BootstrapDialog.TYPE_SUCCESS,message:$("<div><\/div>").load("/User/AddUserComponent?id="+n),closeByBackdrop:!1,closeByKeyboard:!1,onshown:function(){GetCountryList()}})}function Delete(n){BootstrapDialog.confirm({title:"<b>DELETE USER<\/b>",message:"Are you sure want to delete this user ?",closable:!0,type:BootstrapDialog.TYPE_DANGER,btnCancelLabel:"CANCEL",btnOKLabel:"DELETE",btnOKClass:"btn-danger",callback:function(t){t&&$.ajax({url:"/api/Test/DeletebyId?id="+n,type:"DELETE",success:function(n){n==1?($tbltestimonialtab.api().ajax.reload(),$(".modal").modal("hide"),toastr.success("User has been deleted successfully.","Success")):toastr.error("Something went to wrong!","Error")},error:function(n){console.log(n)}})}})}function IsActive(n,t){var i=n==1?"DEACTIVE":"ACTIVE",r=n==1?"deactive":"active";BootstrapDialog.confirm({title:"<b>"+i+" USER <\/b>",closable:!0,message:"Are you sure want to "+r+" this user ?",type:BootstrapDialog.TYPE_DANGER,btnCancelLabel:"CANCEL",btnOKLabel:i,btnOKClass:n==1?"btn-danger":"btn-success",callback:function(n){n&&$.ajax({url:"/api/Test/IsActiveUser?id="+t,type:"POST",success:function(n){n.isSuccess?($tbltestimonialtab.api().ajax.reload(),$(".modal").modal("hide"),toastr.success(n.message,"Success")):toastr.error("Something went to wrong!","Error")},error:function(n){console.log(n)}})}})}function UserValidation(){$("#userForm").bootstrapValidator({fields:{FirstName:{validators:{notEmpty:{message:"First Name is required."}}},LastName:{validators:{notEmpty:{message:"Last Name is required."}}},Email:{validators:{notEmpty:{message:"Email address is required."},regexp:{regexp:"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,6}$",message:"Invalid email address."}}},Address:{validators:{notEmpty:{message:"Address is required."}}},Pincode:{validators:{notEmpty:{message:"Pincode is required."},regexp:{regexp:"^[1-9][0-9]{5}$",message:"Invalid Pincode."}}},CountryId:{validators:{notEmpty:{message:"Country is required."}}},StateId:{validators:{notEmpty:{message:"State is required."}}},Phone:{validators:{notEmpty:{message:"Phone is required."},regexp:{regexp:/^\d{10}$/i,message:"Invalid Phone Number."}}},Password:{validators:{notEmpty:{message:"Password is required."},identical:{field:"ConfirmPassword",message:"The password and its confirm are not matched."}}},ConfirmPassword:{validators:{notEmpty:{message:"Confirm Password is required."},identical:{field:"Password",message:"The password and its confirm are not matched."}}}}})}function ResetForm(){$("#userForm").bootstrapValidator("resetForm",!0);$("#userimage").attr("src","/images/user/user.png")}function backOnList(){window.location.href="/User"}function readURL(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(n){$("#blah").attr("src",n.target.result)};t.readAsDataURL(n.files[0])}}function GetCountryList(){var n=Number($("#hiddenCountryId").val());$.ajax({url:"/User/loadCountry",success:function(t){var i="";i+='<option value="" selected>--select country--<\/option>';$.each(t.data,function(t,r){i+=n==r.countryId?'<option value="'+r.countryId+'" selected>'+r.countryName+"<\/option>":'<option value="'+r.countryId+'">'+r.countryName+"<\/option>"});$("#ddlcountry").html(i);n>0&&GetStateList()}})}function GetStateList(){var n=Number($("#ddlcountry").val()),t=Number($("#hiddenStateId").val());$.ajax({url:"/User/loadState?id="+n,success:function(n){var i="";i+='<option value="" selected>--select state--<\/option>';$.each(n.data,function(n,r){i+=t==r.stateId?'<option value="'+r.stateId+'" selected>'+r.stateName+"<\/option>":'<option value="'+r.stateId+'">'+r.stateName+"<\/option>"});$("#ddlstate").html(i)}})}function generatePdf(){var t=$("#dvContainer").html(),n=window.open("","");n.document.write("<html><head><title>User Report<\/title>");n.document.write("<\/head><body>");n.document.write(t);n.document.write("<\/body><\/html>");n.document.close();n.print()}function SaveUser(){var r=this,t,n,i;$("#userForm").submit(function(n){n.preventDefault()});$("#userForm").data("bootstrapValidator").validate();t=$("#userForm").data("bootstrapValidator").isValid();t&&(n=new FormData,i={UserId:Number($("#hiddenUserId").val()),FirstName:$("#FirstName").val(),LastName:$("#LastName").val(),Email:$("#Email").val(),Gender:document.querySelector('input[name="Gender"]:checked').value,Address:$("#Address").val(),CountryId:Number($("#ddlcountry").val()),StateId:Number($("#ddlstate").val()),ImagePath:"",Pincode:$("#Pincode").val(),Latitude:$("#hiddenLatitude").val(),Longitude:$("#hiddenLongitude").val(),Phone:$("#Phone").val(),IsActive:$("#IsActive")[0].checked?1:0,Password:$("#Password").val(),ConfirmPassword:$("#ConfirmPassword").val()},n.append("model",JSON.stringify(i)),n.append("img",$("#Image")[0].files[0]),$.ajax({url:"/api/Test/SaveUser",type:"POST",contentType:!1,data:n,cache:!1,processData:!1,success:function(n){n.isSuccess?($tbltestimonialtab.api().ajax.reload(),$(".modal").modal("hide"),toastr.success(n.message,"Success")):toastr.error(n.message,"Error")},error:function(n){console.log(n)}}))}function searchUser(){$("#userdatatableresponsive").DataTable().search($("#searchUserString").val()).draw()}function imageSelect(){$("#Image").click()}var $tbltestimonialtab=null;$(document).ready(function(){$("li[group=liGroup]").each(function(){$(this).removeAttr("class")});$("#liUsers").addClass("active");setTimeout(function(){$tbltestimonialtab=$("#userdatatableresponsive").dataTable({ajax:{url:"/User/loaddata",type:"GET",cache:!1,datatype:"json"},bLengthChange:!1,paging:!0,searching:!0,ordering:!0,bLengthChange:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],columns:[{aTargets:[1],sName:"",sClass:"centerc",ordering:!1,render:function(n,t,i){return'<a href="'+i.imagePath+"?="+Math.random()+'" data-fancybox="gallery" data-caption="'+i.firstName+'" "'+i.lastName+'" class="img-class"><img id="blah" src="'+i.imagePath+"?="+Math.random()+'" alt="your image" width="45" height="45" onError="this.onerror=null;this.src="/images/user/user.png";"/><\/a>'}},{data:"firstName",autoWidth:!0,bSortable:!0},{data:"lastName",autoWidth:!0},{data:"email",autoWidth:!0},{data:"gender",autoWidth:!0},{data:"countryName",autoWidth:!0},{data:"stateName",autoWidth:!0},{data:"pincode",autoWidth:!0},{aTargets:[8],sName:"",bSortable:!1,sClass:"centerc",render:function(n,t,i){var r=i.isActive==1?"glyphicon glyphicon-eye-open":"glyphicon glyphicon-eye-close";return' <a onclick = "return IsActive('+i.isActive+","+i.userId+');" title = "Active-Deactive User" > &nbsp;&nbsp; <i class="'+r+' text-primary"><\/i><\/a> <a onclick="return manageUserData('+i.userId+');" title="Edit"> &nbsp;&nbsp;<i class="glyphicon glyphicon-edit text-success"><\/i><\/a> <a onclick = "return Delete('+i.userId+');" title = "Delete" > &nbsp;&nbsp; <i class="glyphicon glyphicon-trash text-danger"><\/i><\/a> '}}],language:{emptyTable:"<div class='row'><div class='col-md-12'><div class='alert alert-info'><p><strong>No record found.<\/strong><\/p> <\/div><\/div>"}})},500)});$("#ddlStatus").change(function(){$tbltestimonialtab.api().ajax.reload()});$("#ddlUsers").change(function(){$tbltestimonialtab.api().ajax.reload()});UserValidation();GetCountryList();